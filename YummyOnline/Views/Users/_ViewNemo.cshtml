

<div class="box box-default">
	<div class="box-body">
		<div class="row">
			<div class="col-md-6">
				<p class="no-margin"><b>匿名用户总数：</b> {{nemoes.Count}}</p>
			</div>
			<div class="col-md-6 text-right">
				@if(User.IsInRole(nameof(YummyOnlineDAO.Models.Role.SuperAdmin))) {
					<p class="no-margin">
						<b>删除未点单的匿名用户：</b>
						<button class="btn btn-xs btn-danger" confirm-click="deleteNemoesHavenotDine()">删除</button>
					</p>
				}
			</div>
		</div>
	</div>
</div>


<div class="box box-default">
	<div class="box-header">
		<h3 class="box-title">近 {{days}} 日匿名用户</h3>
		<div class="box-tools pull-right">
			<div class="btn-group" uib-dropdown>
				<button class="btn btn-box-tool" uib-dropdown-toggle>
					<i class="fa fa-chevron-down"></i>
				</button>
				<ul uib-dropdown-menu>
					<li><a href="javascript:;" ng-click="refresh(7)">近 7 日</a></li>
					<li><a href="javascript:;" ng-click="refresh(14)">近 14 日</a></li>
					<li><a href="javascript:;" ng-click="refresh(30)">近 1 月</a></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="table-responsive">
		<table class="table no-margin">
			<tr>
				<th>Id</th>
				<th>生成日期</th>
				<th>历史点单数量</th>
				<th></th>
			</tr>
			<tbody ng-repeat="nemo in nemoes.Users">
				<tr>
					<td>{{nemo.Id}}</td>
					<td>{{nemo.CreateDate | date:'yyyy/M/d HH:mm:ss'}}</td>
					<td>{{nemo.DineCount}}</td>
					<td class="text-right">
						<button class="btn btn-primary" ng-click="showUserDines(nemo)">
							<span ng-show="nemo.IsLoading">正在查询...</span>
							<span ng-hide="nemo.IsLoading">查询历史订单</span>
						</button>
					</td>
				</tr>
				<tr ng-show="nemo.IsShowUserDines">
					<td colspan="4" class="bg-gray-light">
						<p class="text-danger no-margin" ng-if="nemo.DineHotels.length == 0">无订单</p>
						<div ng-repeat="dineHotel in nemo.DineHotels">
							<h4>{{dineHotel.Hotel.Name}} <small>{{dineHotel.Hotel.Id}}</small></h4>
							<div class="waterfall-4">
								<div class="waterfall-item" ng-repeat="dine in dineHotel.Dines">
									@Html.Partial("~/Views/Users/_PartialDines.cshtml")
								</div>
							</div>
							<hr ng-show="$index + 1 != nemo.DineHotels.length" />
						</div>
					</td>
				</tr>
			</tbody>


		</table>
	</div>
</div>
